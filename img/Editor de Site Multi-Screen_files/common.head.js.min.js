(function(d){var l={};Object.defineProperty(d,"uiPerms",{configurable:!1,enumerable:!0,writable:!1,value:l});d.initUIPerms=function(h){var d;"string"===typeof h&&(h=JSON.parse(atob(h)));for(d in h)Object.defineProperty(l,d,{configurable:!1,enumerable:!0,writable:!1,value:h[d]})}})(window);(function(d){function l(a){var b=e(a).grade;a=q(a).map(function(a){return a.planId+""});var c=Math.min(),f=c;a.filter(function(a){return e(a).grade>b}).forEach(function(a){a=e(a);f=Math.min(a.grade,f)});return c===f?[]:a.filter(function(a){return e(a).grade===f})}function h(a){return l(a).map(e)}function r(a){var b;a=e(a);b="TIER"+a.grade;"MOBILE"===a.type&&(b+="_MOBILE");return b}function k(a,b,c){var f=!1;a=v(a);b=e(b?b:getSafe("$.dmx.site.planId")).planId;f=!!a&&n(a.availableInPlans,b);a&&t[a.id]&&
(f=f&&t[a.id](b,c));return f}function w(a){return e(a).canResellerPublish}function u(a,b,c,f){var d=q(a),g=Math.min(),h;d.forEach(function(d){k(b,d,f)&&d.grade<g&&(e(a).grade<d.grade||!c)&&(h=d,g=d.grade)});return h}function q(a){a=e(a);for(var b=[a],c=a;null!=c.parentId;)c=e(c.parentId),b.push(c);x(a,b);return b}function x(a,b){a.children&&0!=a.children.length&&a.children.forEach(function(a){a=e(a);b.push(a);x(a,b)})}function B(a){Object.keys(a).forEach(function(b){var c=a[b];p(c,{tooltipSettings:c.tooltipSettings?
c.tooltipSettings:{title:"",upgrades:[]},featuresMetadata:y[b+""]||{}})});return a}function C(a){Object.keys(a).forEach(function(b){Object.keys(a[b]).forEach(function(c){Object.keys(a[b][c]).forEach(function(f){a[b][c][f]=d.dmStr[a[b][c][f]]||a[b][c][f]})})});return a}function D(){var a={},b=Object.keys(g);b.forEach(function(b){g[b].features.forEach(function(b){a[b]=a[b]||{name:E[b]||b,tiers:[],availableInPlans:[],minimalPlan:Math.min(),id:b}})});Object.keys(a).forEach(function(c){b.forEach(function(b){var d=
g[b],e=r(d);!n(a[c].availableInPlans,b)&&n(d.features,c)&&(n(a[c].tiers,e)||a[c].tiers.push(e),a[c].availableInPlans.push(b))});a[c].tiers.sort()});return a}function F(){Object.keys(g).forEach(function(a){a=g[a];Object.freeze(a.tooltipSettings);Object.freeze(a)});Object.freeze(g);Object.keys(m).forEach(function(a){Object.freeze(m[a])});Object.freeze(m)}function n(a,b){var c=-1!==a.indexOf(b)||b&&b.toString&&-1!==a.indexOf(b.toString());c||(b=b.toString(),c=-1!==a.indexOf(b)||b&&b.toString&&-1!==a.indexOf(b.toString()));
return c}function p(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]});return a}function e(a){"object"!==typeof a?a=g[a.toString()]:a.id&&(a=g[a.id]);return a}function v(a){"object"!==typeof a&&(a=m[a]);return a}var E={USE_CUSTOM_DOMAIN:"custom-domain",BACKUPS:"site-backup",HIDE_PAGE_PER_DEVICE:"hide-page-per-device",EDIT_BACKGROUND:"edit-background",HIDE_PER_DEVICE:"hide-per-device",CSS_EDITOR:"css-editor",REMOVE_FOOTER:"remove-footer",URL_REDIRECT:"url-redirect",ECOMMERCE_MEDIUM:"100-products-store",
ECOMMERCE_LARGE:"2500-products-store",ECOMMERCE_X_LARGE:"unlimited-products-store",PASSWORD_PROTECTED_PAGES:"password-protected-pages"},t={USE_CUSTOM_DOMAIN:function(a){return d.isReseller?w(a):!0},ADD_PAGE:function(a){return g[a].featuresMetadata.ADD_PAGE&&(a=g[a].featuresMetadata.ADD_PAGE.pages_limit)?(a=parseInt(a),-1==a||$.dmx.sitePages.length-1<a):!0},CUSTOM_WIDGET:function(a,b){var c=g[a],f=c.featuresMetadata.CUSTOM_WIDGET;if(f&&f["allowed.widgets"]&&b){f=f["allowed.widgets"].split(",").map(function(a){return a.trim()});
if(0<=_.indexOf(f,b.widgetId))return!0;if(null!=c.parentId)return t.CUSTOM_WIDGET(c.parentId,b)}return!1}},G="12356789".split(""),g={},m={},z={},y={},A={};p(z,{init:function(a){var b=JSON.parse(atob(a.encodedPlans));a=JSON.parse(atob(a.encodedPlanFeaturesMetadata));p(y,C(a));p(g,B(b));p(m,D());F()},isFreePlan:function(a){return(a=e(a))?a.isFree&&this.isDPlan(a):!1},getTierName:r,plans:g,features:m,getNextPlansIds:l,getNextPlans:h,getNextTiers:function(a){return h(a).map(r).sort()},isFeatureInPlan:k,
getPlanObject:function(a){return e(a)},getPlanStoreSize:function(a){var b;k("ECOMMERCE_X_LARGE",a)?b="extralarge":k("ECOMMERCE_LARGE",a)?b="large":k("ECOMMERCE_MEDIUM",a)?b="medium":k("ECOMMERCE_SMALL",a)&&(b="small");return b},getPlanStoreSizeKey:function(a){var b;k("ECOMMERCE_X_LARGE",a)?b="ECOMMERCE_X_LARGE":k("ECOMMERCE_LARGE",a)?b="ECOMMERCE_LARGE":k("ECOMMERCE_MEDIUM",a)?b="ECOMMERCE_MEDIUM":k("ECOMMERCE_SMALL",a)&&(b="ECOMMERCE_SMALL");return b},getMaximalPlan:function(a){a=q(a);var b=Math.max(),
c;a.forEach(function(a){a.grade>b&&(c=a,b=a.grade)});return c},getMinimalPlanWithFeature:u,getPlanDisplayName:function(a){a=e(a)?e(a).name:"unknown";return d.dmStr["ui.plans."+a]||a},canResellerPublishWithinPlan:w,getPlanFeatureMetadata:function(a,b){b=v(b);if(!b)return null;var c=u(a,b);return c?c.featuresMetadata[b.id]:null},getFilterablePlans:function(){return[3,2,6,7,5].map(e).filter(function(a){return"undefined"!==typeof a})},isDPlan:function(a){a=a||$.dmx.site.planId;a=e(a);return n(G,a.planId)},
addWidgetFeature:function(a,b){A[a]=b},getWidgetFeature:function(a){return A[a]},isFeatureAvailableInTier:function(a,b){return null!=u(a,b,!1)},getAllTierPlans:q});d.plansService=z})(window);(function(d){var l={openPopup:function(d){$.modulesManager.getModuleAsync("stripePopup").then(function(l){l.openStripePopup(d)})}};d.$&&($.stripeService=l)})(window);
(window.webpackJsonpeditor=window.webpackJsonpeditor||[]).push([[34],{AXiQ:function(e,t,n){"use strict";var o=n("yXPU"),l=n.n(o),r=n("7jD/"),s=n.n(r),a=n("k4gB"),d=n("d8FT"),c=n.n(d),m=n("EOhk"),h=["bold","italic","underline"],f={},u={};function g(e){f=e,u=e;var t={color:x({id:"color",styleName:"color",widgetUrl:"/editor/ed/src/editables/common/ed.super.buttonsHtmlColor.jsp",execCommandKey:"foreColor",initMethod:function(e,t){var n=f.controlsBar.find(".richTextEditorColorWrap#divToShowPalette");f.controlsBar.find("#color").off("click.toggle").on("click.toggle",function(e){$.Editor.openColorPicker({event:e,onChange:function(e){$.browser.msie&&null!=m.a._saved_selection&&_RTE_Element.restoreSelection(m.a._saved_selection),_RTE_Element.restoreSelection(m.a._saved_selection),u.applyStyleOnSelection({execCommandKey:"foreColor",styleName:"color",styleValue:e,useStyleMarkupElements:!0}),u._operateOnMatching("font",function(e){var t=e.attr("color");t&&(e.css("color",t),e.removeAttr("color"))}),f.controlsBar.find(".DisplayBGselected").css("background-color",e),u._addToUndo()},onClose:function(){f.element.focus()},currentColor:u.queryValue("foreColor"),appendToElement:"#divToShowPalette"}),n.show()}),f.controlsBar.find(".DisplayBGselected").css("background-color",f.element.css("color"))},updateState:function(e){var t=f.controlsBar.find(".DisplayBGselected"),n=u.queryValue("foreColor");t.css("background-color",n)},onHide:function(){f.controlsBar.find("#divToShowPalette").hide()}}),fontFamily:x({id:"fontFamily",styleName:"font-family",execCommandKey:"fontName",widgetUrl:"/editor/ed/jsp/ed.super.designHtmlFontFamily.jsp",setCorrectFontFamily:function(){const e=$(".dmRteControlButton_fontFamily").next().find("li");$.each(e,function(e,t){var n=$(t);n.css({fontFamily:n.data().value})})},openWidget:function(e,t){},onHide:function(){$(".minict_wrapper ul").hide()},initMethod:function(e,t){var n=$(".dmRteControlButton_fontFamily"),i=e;i&&(-1!==i.indexOf("'")&&(i=i.substr(1,i.length-2)),0==i.indexOf('"')&&(i=i.substr(1,i.length-1)),-1!==i.indexOf(",")&&(i=i.replace(/,/g,"").replace(/'/g,"")));var o=f.controlsBar.is(".dmSmallRte")?100:110;function l(e,i){f.controls.fontWeight&&E(e,f.controls.fontWeight._update),f.disableCallback=!1,n.val(e).change(),n.next(".minict_wrapper").find("input").css("font-family","'"+e+"'"),t(e)}function r(){$.Editor.closePopup(),$(".changeColorPopup .closeColorPicker").trigger("click")}setTimeout(()=>{n.styleSelectBox(l,{width:o,isFirstTime:!1,searchable:!0,onopen:r})},0),f.disableCallback=!0,n.val(i).change(),n.next(".minict_wrapper").find("input").css("font-family","'"+i+"'"),this.setCorrectFontFamily(),n.closest(".minict_wrapper").off("click.closeothers").on("click.closeothers",function(e){$.Editor.closePopup(),$(".changeColorPopup .closeColorPicker").trigger("click")}),f.disableCallback=!0,f.controls.fontWeight&&E(i,f.controls.fontWeight._update)},updateState:function(){var e=$(".dmRteControlButton_fontFamily"),t=($.dmx.preview.doc().queryCommandValue("fontName")||"").replace(/'/g,"").replace(/"/g,"");(!t||t.indexOf("Thread")>-1)&&(t=(u._getStyleValues("font-family")||[""])[0]),e.next().find("input").val(t).attr("placeholder",t),e.next(".minict_wrapper").find("input").css("font-family","'"+t+"'"),e.next(".minict_wrapper").find("li").removeClass("selected"),/\s+/.test(t)&&(t='"'+t+'"'),e.next(".minict_wrapper").find("li[data-value="+t+"]").addClass("selected"),f.disableCallback=!0,this.setCorrectFontFamily()}}),titleType:x({id:"tagTypeControl",styleName:"formatBlock",forceInitFromCache:!0,initMethod:function(){var e=f.element[0].tagName,t=f.controlsBar.find("#headingTagType");if(0===f.element[0].tagName.indexOf("H")){t.val(e),t.next(".minict_wrapper").length?(t.next().find("input").val(e).attr("placeholder",e),t.next(".minict_wrapper").find("li").removeClass("selected"),t.next(".minict_wrapper").find("li[data-value="+e+"]").addClass("selected")):t.styleSelectBox(function(e){$(f.element[0]).changeTagType(e),$.dmx.current.element=f.element=$.dmfw.getPreviewElement(".dmNowInlineEditing")},{isFirstTime:!1,searchable:!0,onopen:function(){$.Editor.closePopup(),$(".changeColorPopup .closeColorPicker").trigger("click")},dd:t,addNonExisting:!1,width:60}),f.controlsBar.find("#rteHeadingTagType").show()}else f.controlsBar.find("#rteHeadingTagType").hide()},updateState:function(){var e=f.element[0].tagName,t=f.controlsBar.find("#headingTagType");f.disableCallback=!0,t.next().find("input").val(e).attr("placeholder",e),t.next(".minict_wrapper").find("li").removeClass("selected"),t.next(".minict_wrapper").find("li[data-value="+e+"]").addClass("selected")}}),fontSize:x({id:"fontSize",styleName:"font-size",widgetUrl:"/editor/ed/jsp/ed.super.designHtmlTextSize.jsp",execCommandKey:"fontSize",openWidget:function(e,t){$("#widgetPlaceholder").neeChangeTextSize(e,t)},initMethod:function(e,t){var n=!0,i=f.controlsBar.find("#fontSize"),o=[8,9,10,11,12,14,16,18,20,22,24,26,28,30,36,48,60,72,96],l=f.element.css("font-size"),r=parseInt(l);-1===o.indexOf(r)&&o.push(r),o.forEach(function(e){i.append($("<option />").attr("value",e+"px").text(e+"px"))}),i.styleSelectBox(function(e){n&&(f.disableCallback=!0,n=!1);t(e)},{isFirstTime:!1,searchable:!0,onopen:function(){$.Editor.closePopup(),$(".changeColorPopup .closeColorPicker").trigger("click")},onfilter:!0,dd:i,suffix:"px",addNonExisting:!0,digitsOnly:!0}),i.val(l).change()},updateState:function(e){var t=u._getStyleValues(e),n=f.controlsBar.find("#fontSize"),i=parseInt(t[0])+"px";f.disableCallback=!0,n.next().find("input").val(i).attr("placeholder",i),n.next(".minict_wrapper").find("li").removeClass("selected"),n.next(".minict_wrapper").find("li[data-value="+i+"]").addClass("selected")},afterSelection:function(e){u._operateOnMatching("[style*='xxx-large']",function(t){u._createAndAddClassForFontSize(t,e)}),u._operateOnMatching("font[size]",function(t){t.removeAttr("size"),u._createAndAddClassForFontSize(t,e)})}}),fontWeight:x({id:"fontWeight",styleName:"font-weight",widgetUrl:"/editor/ed/jsp/ed.super.designHtmlTextSize.jsp",openWidget:function(e,t){},initMethod:function(e,t){},afterSelection:function(e){},onHide:function(){const e=f.controlsBar.find("#fontWeight");e&&e.find(".dd-option-value").length&&e.ddslick("close")},updateState:function(e){var t,n=u._getStyleValues(e),i=f.controlsBar.find("#fontWeight"),o=n[0].toString(),l=u._getStyleValues("font-family")[0].toString();l=l.split(",")[0].replace(new RegExp("['\"]","g"),"").trim();var r=f.fontFamilyWeightsMap[l];r&&r.split(",").length!=i.find(".dd-option-value").length?E(l,f.controls.fontWeight._update):(isNaN(parseInt(o))&&(o=f.fontNameToWeight[o.charAt(0).toUpperCase()+o.slice(1)]),-1===(t=i.find('.dd-option-value[value="'+o+'"]').parents("li").index())&&(t=0),f.disableCallback=!0,i.ddslick("select",{index:t}),i.off("click.closeothers").on("click.closeothers",function(e){$.Editor.closePopup()}))}}),bold:C({id:"bold",styleName:"font-weight",styleOn:"bold",styleOff:"normal",useStyleMarkupElements:!0,execCommandKey:"bold",forceInitFromCache:!0,afterSelection:function(e){var t=f.controlsBar.find("#fontWeight"),n=t.find(".dd-option-text");if(t.size())for(var i=0;i<n.length;i++){if($(n[i]).text().toLowerCase()===e){var o=f.getSelectedNodes(),l=f.disableCallback;f.disableCallback=!!o.length,t.ddslick("select",{index:i}),o.length&&f.selectNode(o[0].nextSibling),f.disableCallback=l;break}}}}),italic:C({id:"italic",styleName:"font-style",execCommandKey:"italic",useStyleMarkupElements:!0,styleOn:"italic",styleOff:"normal"}),underline:C({id:"underline",styleName:"text-decoration",execCommandKey:"underline",styleOn:"underline",styleOff:"none"}),alignLeft:v({id:"alignLeft",styleName:"text-align",styleOn:"left",group:"align",execCommandKey:"justifyLeft"}),alignRight:v({id:"alignRight",styleName:"text-align",styleOn:"right",group:"align",execCommandKey:"justifyRight"}),alignCenter:v({id:"alignCenter",styleName:"text-align",styleOn:"center",group:"align",execCommandKey:"justifyCenter"}),alignJustify:v({id:"alignJustify",styleName:"text-align",styleOn:"justify",group:"align",execCommandKey:"justifyFull"}),lineHeightAuto:y({id:"lineHeightAuto",styleName:"line-height",styleValue:"initial",styleOn:"auto",group:"lineHeight"}),lineHeightSingle:y({id:"lineHeightSingle",styleName:"line-height",styleValue:"normal",styleOn:"100",group:"lineHeight"}),lineHeightOneFifty:y({id:"lineHeightOneFifty",styleName:"line-height",styleValue:"150%",styleOn:"150",group:"lineHeight"}),lineHeightDouble:y({id:"lineHeightDouble",styleName:"line-height",styleValue:"200%",styleOn:"200",group:"lineHeight"}),dirToggle:C({id:"dirToggle",styleName:"direction",styleOn:"ltr",styleOff:"rtl",execCommandKey:"justifyFull",afterSelection:function(e){u._operateAfterExecCommand("[style*='text-align: justify;']",function(t){t.dmCss("direction",e).dmCss("text-align","rtl"==e?"right":"left")}),f.element.dmCss("direction",e).dmCss("text-align","rtl"==e?"right":"left")}}),link:k({id:"link",forceInitFromCache:!0}),binding:T({id:"bindingBtn",handler:function(e){var t=$.dmx.current.element;$.dmx.current.editable.inlineEditor&&$.dmx.current.editable.inlineEditor.editorUtils.disableInlineEdit(),$.deselectAllEditableElements(),t&&t.selectElement&&t.selectElement()}}),bullets:R({id:"bullets",command:"insertUnorderedList",tag:"ul"}),numbers:R({id:"numbers",command:"insertOrderedList",tag:"ol"}),indent:T({id:"indent",handler:function(e){u._applyIndentation("indent"),u._markInnerLists()}}),outdent:T({id:"outdent",handler:function(e){u._applyIndentation("outdent"),u._markInnerLists()}}),clearFormat:T({id:"clearFormat",iterable:!0,refreshState:$.noop,handler:function(e){u._clearFormatting()}}),settings:T({id:"settings",handler:function(e){$.dmx.current.editable.inlineEditor.editorUtils.controls.edit.handler(f.element,$(e.target),e)}}),close:T({id:"close",handler:function(e){var t=$.dmx.current.element;$.dmx.current.editable.inlineEditor&&$.dmx.current.editable.inlineEditor.editorUtils.disableInlineEdit(),$.deselectAllEditableElements(),t&&t.selectElement&&t.selectElement()}}),save:{element:null,buttonClassName:"DMRTESaveBtn",title:"Save",state:!1,iterable:!1,handler:function(){u.saveChanges(!0)}}};return t=c()(t,function(e,t){return!e.disable}),f.controls=t,t}function p(){var e=f.fontFamilyWeightsMap={};document.querySelectorAll("#fontFamily option").forEach(function(t){var n=t.getAttribute("weight"),i=t.getAttribute("value");n&&(e[i]=n)})}function E(e,t){if(f.controls.fontWeight){var n,i=f.fontFamilyWeightsMap[e];n=null!=i?i:"400,700";var o=f.controlsBar.find("#fontWeightHolder");o.empty();var l=$("<select></select>");o.append(l),l.attr("id","fontWeight").addClass("ptUndesignFF");for(var r=n.split(","),s=f.controls.fontWeight._getCurrent(),a=0;a<r.length;a++){var d=r[a].replace(/ /g,"");if(""!==d){var c=$("<option></option>");l.append(c),c.text(f.fontWeightToName[d]).attr("value",d),s==d&&l.val(d)}}l.styleSelectBox(t,{isFirstTime:!1,onopen:function(){$.Editor.closePopup(),$(".changeColorPopup .closeColorPicker").trigger("click")}}),l.off("click.closeothers").on("click.closeothers",function(e){$.Editor.closePopup(),$(".changeColorPopup .closeColorPicker").trigger("click")})}}function y(e){return e=e||{},$.extend(e,{wrapSelection:!0,addToClick:function(e){var t={serverOptions:{element:f.element,deviceSpecific:!0},cssContext:{attrToAdd:[{attr:e.styleName,value:e.styleValue}]}};return S(e.styleOn),f.element.css(e.styleName,e.styleValue),$.dmBlockUI(null,!0),$.dmops.updateCss(t).done(function(){$.dmUnblockUI()}),!0},addToRefreshState:function(){var e="auto",t=parseInt(f.element.css("lineHeight")),n=parseInt(f.element.css("fontSize"));t===n||isNaN(t)?e="100":t===1.5*n?e="150":t===2*n&&(e="200"),S(e)}}),b(e)}function v(e){return e=e||{},$.extend(e,{wrapSelection:!0,addToClick:function(e){return w(e.styleOn),u.queryState(e.execCommandKey)},addToRefreshState:function(e){w()}}),b(e)}function C(e){var t={};return t.id=e.id,t.hasEditor=!1,t.isToggle=!0,t.iterable=!0,t.state=!1,t.wrapSelection=e.wrapSelection,t.forceInitFromCache=e.forceInitFromCache,t.handler=function(){u.applyStyleOnSelection({execCommandKey:e.execCommandKey,styleName:e.styleName,useStyleMarkupElements:e.useStyleMarkupElements,styleValue:t.state?e.styleOff:e.styleOn,wrapSelection:t.wrapSelection}),u._addToUndo(),t.state=!t.state,t.element.toggleClass("on"),e.afterSelection&&e.afterSelection(t.state?e.styleOn:e.styleOff)},t.refreshState=function(n){N(t,e.styleName,e.styleOn,n)},t}function S(e){var t=f.controlsBar.find("#lineHeightIndicator"),n="";t.removeClass("dm-icon-line_hight_auto dm-icon-line_hight_1 dm-icon-line_hight_15 dm-icon-line_hight_2"),n="100"===e?"dm-icon-line_hight_1":"150"===e?"dm-icon-line_hight_15":"200"===e?"dm-icon-line_hight_2":"dm-icon-line_hight_auto",t.addClass(n)}function w(e){var t="left",n=f.controlsBar.find("#alignIndicator").removeClass("dm-icon-align-left dm-icon-align-right dm-icon-align-center dm-icon-align-justify");e?t=e:u.queryState("justifyRight")?t="right":u.queryState("justifyCenter")?t="center":u.queryState("justifyFull")&&(t="justify"),n.addClass("dm-icon-align-"+t).attr("title","justify"==t?t:t+" align")}function b(e){var t={};return t.id=e.id,t.hasEditor=!1,t.isToggle=!1,t.iterable=!0,t.group=e.group,t.wrapSelection=e.wrapSelection,t.handler=function(){var n=!1;e.addToClick&&(n=(n=e.addToClick(e))||!1),n||(u.applyStyleOnSelection({execCommandKey:e.execCommandKey,styleName:e.styleName,styleValue:e.styleOn,wrapSelection:t.wrapSelection}),u._addToUndo())},t.refreshState=function(){e.addToRefreshState&&e.addToRefreshState(e),N(t,e.styleName,e.styleOn)},t}function x(e){var t={};return t.id=e.id,t.hasEditor=!0,t.isToggle=!1,t.iterable=!0,t.state=!1,t.forceInitFromCache=e.forceInitFromCache,t._update=function(t){var n=t;$.browser.msie&&(m.a._saved_selection&&_RTE_Element.restoreSelection(m.a._saved_selection),"fontSize"==e.execCommandKey&&(n=7)),f.disableCallback?f.disableCallback=!1:(u.applyStyleOnSelection({execCommandKey:e.execCommandKey,styleName:e.styleName,styleValue:n}),e.afterSelection&&e.afterSelection(t),u._addToUndo())},t._getCurrent=function(){return u._getStyleValues(e.styleName)[0]},t.handler=function(){$.dmLoad("#widgetPlaceholder",e.widgetUrl,function(){e.openWidget(t._getCurrent(),t._update),t.loaded=!0})},e.initMethod&&(t.initMethod=function(){e.initMethod(t._getCurrent(),t._update)}),t.refreshState=function(){t.loaded&&$("#"+t.id).is(".selected")&&e.openWidget(t._getCurrent(),t._update),e.updateState&&e.updateState(e.styleName)},e.onHide&&(t.onHide=e.onHide),t}function T(e){var t={};return t.id=e.id,t.handler=e.handler,t.additionalClasses=e.additionalClasses,t.iterable=e.iterable,t.refreshState=e.refreshState||$.noop,t.disable=e.disable||!1,t}function R(e){var t={id:e.id,hasEditor:!1,iterable:!0,state:!1,opened:!1,command:e.command||"insertUnorderedList",tag:e.tag||"ul"};return t.handler=function(){var e,n;if(!$("#"+t.id).is(".disabled")){$("#"+t.id).toggleClass("on");var o=f.element.parent();o.attr("contenteditable",!0);var l=NEFW.getPreviewWindow().document;try{l.getSelection().getRangeAt(0).commonAncestorContainer.id}catch(e){}if(l.execCommand(t.command,!1,null),e=l.getSelection().getRangeAt(0).commonAncestorContainer.children)for(i=0;i<e.length;i++)(n=e[i].querySelector("span"))&&(n.style.lineHeight="normal");o&&o.removeAttr("contenteditable"),u._markInnerLists(),u._handleAction(),f.refreshControlsState()}},t.refreshState=function(){f.element.is("ul, ol")||f.element.is("h1, h3")?$("#"+t.id).addClass("disabled"):($("#"+t.id).removeClass("disabled"),f._isSelectedElementOfWrappedByTag(t.tag)?(t.state=!0,$("#"+t.id).addClass("on")):(t.state=!1,$("#"+t.id).removeClass("on")))},t}function k(e){var t={id:e.id,hasEditor:!1,iterable:!0,state:!1,opened:!1,forceInitFromCache:e.forceInitFromCache,openLinkPicker:function(e){f.keepEditableBar=!0,f.openLinkPicker(e)},openWidgetOnExisting:function(){var e=u._getSelectedElementWrappedByTag("a","href");null!=e&&u.selectNode(e),t.openLinkPicker({href:e.attr("href"),raw_url:e.attr("raw_url"),target:e.attr("target"),file:e.attr("file"),link_type:e.attr("link_type"),popup_target:e.attr("popup_target")})},openWidgetOnNew:function(e){var n="/site/"+$.dmx.site.alias+"/home",i=$.dmfw.finalyzeRuntimeUrl(n),o=e.text;o&&($.validateEmail(o)?i=n="mailto:"+o:$.validateURLII(o)&&(i=n=o.startsWith("http")||o.startsWith("ftp")?o:"http://"+o)),t.openLinkPicker({href:n,raw_url:i})},handler:function(){if(!$("#"+t.id).is(".disabled")){var e=u.getSelection();$("#"+t.id).addClass("selected"),t.state?t.openWidgetOnExisting():e.collapsed?$("#"+t.id).removeClass("selected"):t.openWidgetOnNew({text:e.toString()})}},refreshState:function(e){var n=$("#"+t.id);if(!0===e||!1!==e&&u._isSelectedElementOfWrappedByTag("a","href"))t.state=!0,n.addClass("on"),n.removeClass("disabled");else{t.state=!1,n.removeClass("on");var i=u.getSelection();!i||i.collapsed||""==i.toString()?n.addClass("disabled"):n.removeClass("disabled")}}};return t}function N(e,t,n,i){if(h.indexOf(n)>=0){if(!1===i||!0!==i&&!u.queryState(n))return e.state=!1,void e.element.removeClass("on")}else{var o=u._getStyleValues(t);if(0==o.length)return e.state=!1,void e.element.removeClass("on");for(var l=0;l<o.length;l++){if(o[l].toString().indexOf(n)<0)return e.state=!1,void e.element.removeClass("on")}}e.state=!0,e.element.addClass("on")}var B=n("9Mi+"),A=n("ezYY"),P=n("o/li"),W=n("4YHD"),O=n("zrZZ"),F=n("4DUh"),I=n("dF1e"),L=n("Bmz3"),H=n("LyWx"),M=n("9iID"),z=n("B5qv");const D="inline-bind-applied";let j=0,U=!1;function K(){const e=document.getElementById("bindingBtn");if(Z()||F.a.isSMB())e.parentNode.removeChild(e);else if(!U&&e){U=!0;const t=function(){const e=document.createElement("div");return e.innerHTML=`<div class='content'>\n    ${Object(a.o)("dynamicPages.inline.help")}\n    <div class='learn-more'>${Object(a.o)("dynamicPages.inline.help.learn.more")}</div>\n</div>`,e.classList.add("inline-binding-popper"),e.addEventListener("mouseenter",()=>{e.classList.add("show")}),e.addEventListener("mouseleave",()=>{e.classList.remove("show")}),e.querySelector(".learn-more").addEventListener("click",()=>{O.a.openHelpPopup("ed_connected_data")}),e}(),n=function(e,t){return new z.a(e,t,{placement:"top",modifiers:{flip:{behavior:["left","bottom","top"]},preventOverflow:{boundariesElement:document.querySelector("#edPreview")}}})}(e,t);document.querySelector("#edPreview").appendChild(t),function(e,t,n){e.addEventListener("mouseenter",()=>{n.update(),t.classList.add("show")}),e.addEventListener("mouseleave",e=>{e.toElement.matches(".inline-binding-popper")||t.classList.remove("show")})}(e,t,n)}}function q(){return(q=l()(function*({currentElement:e,elementId:t,applyBind:n}){return e.innerText.includes("{{")?(e.removeEventListener("keyup",X,{passive:!0}),window.requestAnimationFrame(()=>{window.requestAnimationFrame(l()(function*(){const{value:i}=yield function(e){return V.apply(this,arguments)}({elementId:t,applyBind:n});if(e.innerHTML=J(i).innerHTML,e.querySelector(".partial-binding-container"))return;const o=J("\n<div class='partial-binding-container'>\n    <div class='data-binding-indicator'></div>\n</div>\n    ");e.appendChild(o)}))})):Promise.resolve()})).apply(this,arguments)}function V(){return(V=l()(function*({elementId:e,applyBind:t}){const n=function(){const{currentCollectionRow:e}=L.collectionsState;if(e)return e;return""}(),i=`/data_binding/bindings/${Object(A.b)()}/${e}/${t}`;return Object(B.b)({url:i,queryData:{dynamicPageItem:n}})})).apply(this,arguments)}function G(){return(G=l()(function*({currentElement:e,elementId:t}){if(!function({currentElement:e}){if(Z())return!1;return e.innerText.includes("{{")}({currentElement:e}))return Promise.resolve();const n=[{elementId:t,attributesToChange:{[D]:!0}}];return yield W.K(n)})).apply(this,arguments)}function X(e){!function(e){if(16===e.keyCode)return;if(e.shiftKey&&219===e.keyCode)return void(j+=1);j=0}(e),3===j&&(j=0,window.$.Editor.openSimpleBinding({elementId:e.target.id,callback:t=>{e.target.focus(),window.requestAnimationFrame(()=>{e.target.innerHTML=e.target.innerHTML.replace("{{{",`{{${t}}}`)})}}))}function Z(){return P.a.getAccountPlanType()===H.a.BASIC||!I.l()||!M.a.get("feature.flag.inline.binding")}function J(e){const t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}n.d(t,"a",function(){return Y});class Y{constructor(e){var t=this;this.fontNameToWeight=()=>{const e={};return $.each(this._this.fontWeightToName,(t,n)=>{e[n]=t}),e},this.initializeEditor=()=>{const e=$(this.element),t=this;t.isEditorClosed=!1,$.dmx.preview.wnd().document.body.classList.add("ui-disableEditGrid"),$.dmx.preview.wnd().$.editGrid.removeContextMenu(),$.dmx.current.element.addClass("ui-current-element"),this.element.addClass("dmNowInlineEditing"),this.element.attr("contenteditable",!0),e.find("*").andSelf().filter("img").attr("contenteditable",!1),this.initEditorControls(),this._addToUndo(),$(document.body).off("click","#undoBtn").on("click","#undoBtn",()=>{t._undo()}),$(document.body).off("click","#redoBtn").on("click","#redoBtn",()=>{t._redo()}),$("body").off("keydown.rte").on("keydown.rte",e=>{t._handleKeyDownUndo(e)}),e.off("keydown.rte").on("keydown.rte",e=>{t._handleKeyDown(e)}),e.off("paste.rte").on("paste.rte",e=>{t._handlePaste(e)}),e.off("dragover.rte drop.rte").on("dragover.rte drop.rte",e=>(e.preventDefault(),!1)),e.off("keyup.rte").on("keyup.rte",e=>{null!=_RTE_Element&&(t.fixSize(),e.ctrlKey||e.metaKey||t._addToUndo(),t.controls.link.state&&t.controls.link.refreshState())}),e.off("keypress.rte").on("keypress.rte",e=>{null!=_RTE_Element&&(e.ctrlKey||e.metaKey||t._addToUndo())}),e.off("cut.rte dragend.rte drop.rte change.rte").on("cut.rte dragend.rte drop.rte change.rte",e=>{t._handleAction()}),e.off("mousedown.drag").on("mousedown.drag",()=>{$.preventClicksFromEditor=!0}),e.off("click.drag mouseup.drag").on("click.drag mouseup.drag",()=>{$.preventClicksFromEditor=!1}),$("#fontSize.textControl").click()},this.isModified=()=>{const e=this.cleanClientGeneratedClassesFromElement(this.savedHtml),t=this.cleanClientGeneratedClassesFromElement();return NEFW.getPreviewWindow().styleImages(e),NEFW.getPreviewWindow().styleImages(t),$.each(e.find("*").andSelf().filter('*[class=""]'),(e,t)=>{$(t).removeAttr("class")}),$.each(t.find("*").andSelf().filter('*[class=""]'),(e,t)=>{$(t).removeAttr("class")}),e.outerHTML()!=t.outerHTML()},this.remove=e=>{null===e&&(e=!1),this.saveChanges(!1,null),$.dmx.preview.wnd().document.body.classList.remove("ui-disableEditGrid"),$.dmx.current.element&&$.dmx.current.element.removeClass("ui-current-element"),$(this.element).removeClass("dmNowInlineEditing").removeAttr("contenteditable"),this.element.off("keydown.rte mouseup.rte paste.rte keyup.rte keypress.rte"),$("body").off("keydown.rte"),null==this.controlsBar&&(this.controlsBar=$("")),$.each(_RTE_Element.controls,(e,t)=>{t.onHide&&t.onHide()}),_RTE_Element.controlsBar.find("#dmRteLineHeightTextWrap").hide(),_RTE_Element.controlsBar.find("#dmRteAlignTextWrap").hide(),this.controlsBar.length&&this.controlsBar.hide(),this.allowContentEditable(!1),this.keepEditableBar||$.dmfw.preview.removeEditableBar(),e&&$.deselectAllEditableElements(),this.isEditorClosed=!0},this.isClosed=()=>this.isEditorClosed,this.openLinkPicker=e=>{const t=this;$.dmx.isTouchDevice||(this.allowContentEditable(!1),this.toggleControls(!1),this.preventSelection(!0)),$.Editor.openLinkPicker({manualMode:!0,linkAttributes:e,onChange:function(e){$.dmx.isTouchDevice||(t.allowContentEditable(!0),t.preventSelection(!1)),e&&t._changeHref(e),t.controls.link.refreshState(),$.dmx.isTouchDevice||(t.allowContentEditable(!1),t.toggleControls(!1),t.preventSelection(!0))},onRemove:function(){t.allowContentEditable(!0),t.preventSelection(!1),t._removeLink(),t.toggleControls(!0),t.controls.link.refreshState()},onClose:function(){t.allowContentEditable(!0),t.preventSelection(!1),t.element.focus(),t.toggleControls(!0)},showRemove:!0})},this.handleWindowEvents=e=>{if("mouseup"==e.type||!$.browser.msie&&"selectionchange"===e.type||"keyup"==e.type&&$.isEditKeyCode(e))if($.browser.msie)m.a._saved_selection=_RTE_Element.getSelection();else{if((t=$(e.target)).is("#inlineEditableBar *")||t.is("#inlineEditableBar"))return;this.refreshControlsState(),$.dmfw.isEditorOpen()||this.allowContentEditable(!0),this.useSpotlight()&&$.dm.spotlight&&$.dm.spotlight._positionMask(this.element)}else if("click"==e.type){var t;if((t=$(e.target)).is("#inlineEditableBar *")||t.is("#inlineEditableBar"))return;this.refreshControlsState(),$(".changeColorPopup .closeColorPicker").trigger("click")}},this.refreshControlsState=()=>{const e=_.uniqWith(_.values(this.controls),(e,t)=>e.group&&t.group&&e.group==t.group);$.each(e,(e,t)=>{t.iterable&&t.refreshState()})},this.toggleControls=e=>{this.controlsBar.find("*").css("pointer-events",e?"auto":"none")},this.preventSelection=e=>{e?this.element.on("selectstart.rte select.rte",e=>(e.preventDefault(),!1)):this.element.off("selectstart.rte  select.rte")},this.fixSize=()=>{clearTimeout(m.a._redraw_timer);const e=this.element;m.a._redraw_timer=setTimeout(()=>{e.lockElement({hideOverlay:!0})},200)},this.initRichTextEditorButton=(e,t)=>{const n=$(".dmInlineRichTextEditorWrap #"+e.id);return e.initMethod?e.initMethod():n.off("click").on("click",e=>{$.browser.msie&&null!=m.a._saved_selection&&(_RTE_Element.restoreSelection(m.a._saved_selection),m.a._saved_selection=_RTE_Element.getSelection()),t(e)}),n},this.useSpotlight=()=>commonProps["editor.rte.spotlight"]&&"mobile"!==$.dmfw.getDevice(),this.preloadEditor=()=>{p(),_RTE_Element.initControls(),_RTE_Element.element=null},this.reInitControls=()=>{const e=this;e.controls=g(e),$.each(_RTE_Element.controls,(t,n)=>{if(n.element=$(".dmInlineRichTextEditorWrap #"+n.id),n.forceInitFromCache){e.initRichTextEditorButton(n,function(t){n.hasEditor&&($(".textControl").removeClass("selected"),n.element.addClass("selected"),$("#welcomeText").hide());n.handler(t),n.group&&(n.element.addClass("on"),$.each(e.controls,(e,t)=>{t.group&&t.group==n.group&&t!=n&&t.element.removeClass("on")}))})}})},this.initControls=()=>{const e=this;$.each(_RTE_Element.controls,(t,n)=>{n.element=e.initRichTextEditorButton(n,function(t){n.hasEditor&&($(".textControl").removeClass("selected"),n.element.addClass("selected"),$("#welcomeText").hide());n.handler(t),n.group&&(n.element.addClass("on"),$.each(e.controls,(e,t)=>{t.group&&t.group==n.group&&t!=n&&t.element.removeClass("on")}))})});let t=_RTE_Element.controlsBar.find("#dmRteLineHeightTextWrap"),n=_RTE_Element.controlsBar.find("#dmRteAlignTextWrap"),i=_RTE_Element.controlsBar.find(".dmRteControlButton_alignArrow");_RTE_Element.controlsBar.find(".alignIndicator").off("click.tog").on("click.tog",()=>{i.toggleClass("open"),n.slideToggle(200)}),_RTE_Element.controlsBar.find(".lineHeightIndicator").off("click.tog").on("click.tog",()=>{t.slideToggle(200)})},this.initEditorControls=e=>{const t=this;function n(e){t.controlsBar.show(),$.Editor.openOnBoardingGuidePopup({trigger:$.Editor.getOnBoardingConsts().ON_BOARDING_TRIGGER_TEXT_WIDGET_CLICK});let n,i,o,l,r="dmInlineRichTextEditorWrap DMInlineEditorNotEditableElement"+(commonProps["editor.rte.smalleditor"]?" dmSmallRte dmDarkRte":""),s=$("#_preview_w"),d=$.dmx.preview.wnd().$.DM.isBodyScrollable(),c=0,h=s.offset().top,f=s.offset(),u=s.width(),g=$.dmfw.getPreviewElement("#iscrollBody"),E=g.children("#site_content").height(),_=$.dmfw.getPreviewElement(".dmInner").height(),y=_RTE_Element.element.height(),v=$("#previewWrapper").offset().left,C=v+$("#previewWrapper").outerWidth();function S(e){const r=$.Editor.state.getState("uiState").scaleX||1,g=$.Editor.state.getState("uiState").scaleY||1;setTimeout(()=>{_RTE_Element.controlsBar}),i=parseInt(_RTE_Element.controlsBar.css("width")),l=f.left+_RTE_Element.element.offset().left+_RTE_Element.element.width()/2-i/2,t.controlsBar.is(".dmSmallRte")?(t.controlsBar.find(".dm-icon-x2").removeClass("dm-icon-x2").addClass("dm-icon-ok").attr("title",Object(a.o)("ui.save")),l<v?l=v+20:l+i>C&&(l=C-t.controlsBar.width()-20)):(l<f.left||l+i>u)&&(l=f.left-(t.controlsBar.width()-s.width())/2),l=Math.max(0,l-30),t.controlsBar.offset({left:"mobile"!==$.onefw.device()?Math.max(l*r,f.left):l*r}),$.browser.msie&&_RTE_Element.controlsBar.find(".dmRteControlButton, .dmRteMiddleWrap > *").each((e,t)=>{$(t).off("mousedown.restoreSelection").on("mousedown.restoreSelection",e=>{"mousedown"!=e.type||m.a._saved_selection||(m.a._saved_selection=_RTE_Element&&_RTE_Element.getSelection())})});const p=t.controlsBar.outerHeight(!0);n=$.dmx.current.element.offset(),o=n.top+f.top-p;const E=_RTE_Element.element.offset().top;if(d&&(c=parseInt($.getScrollingPosition()[1])),o-=c,t.controlsBar.outerHeight()>E-c&&E+y+t.controlsBar.height()<s.height()+c&&!e)t.controlsBar.offset({top:(h+E+-c+y+15)*g});else if(o<=h)t.controlsBar.offset({top:h*g});else{const e=$.dmx.isTouchDevice?Math.max(o-70,60):o-10;t.controlsBar.offset({top:e*g})}t.useSpotlight()&&$.dm.spotlight&&$.dm.spotlight._positionMask(t.element)}t.controlsBar.addClass(r),_RTE_Element.element.addClass("inlineEditedElementHighlight"),t.useSpotlight()&&_RTE_Element.element.addClass("inlineEditedElementHighlightNoBorder"),p(),e&&e.fromCache?_RTE_Element.reInitControls():_RTE_Element.initControls(),S(!1),E>_&&g?g.off("scroll.positionEditor").on("scroll.positionEditor",()=>{S(!0)}):$($.dmx.preview.wnd()).off("scroll.positionEditor").on("scroll.positionEditor",()=>{S(!0)}),$.dmx.events.trigger("d1rte.initialized"),setTimeout(()=>{t.controlsBar.draggable({handle:".dmRteDragHandler",iframeFix:!$.dmx.isTouchDevice,containment:"mobile"!==$.onefw.device()?"#PreviewPaneWrapper":"window"})},200),setTimeout(()=>{t.refreshControlsState()},0)}if(t.controlsBar&&t.controlsBar.length)n({fromCache:!0});else{t.controlsBar=$("<div></div>"),$("#PreviewPaneWrapper").append(t.controlsBar);const e=$.dmx.cache.get("richtexteditor");null!=e?(t.controlsBar.html(e.clone().html()),n()):$.dmLoad(t.controlsBar,"/editor/ed/jsp/ed.inlineRichTextEditor.jsp",()=>{n()})}},this._handleKeyDownUndo=e=>{if(e.ctrlKey||e.metaKey){if(90==e.keyCode)return void(!1!==this._undo()&&this._cancelEvent(e));if(89==e.keyCode)return void(!1!==this._redo()&&this._cancelEvent(e))}},this._handleKeyDown=e=>{const t=this;if(this.element.removeClass("dmParagraphPlaceholder").removeClass("dmTitlePlaceholder"),!e.ctrlKey&&!e.metaKey||e.altKey)9==e.keyCode?e.shiftKey?(this._cancelEvent(e),this.controls.outdent.handler()):(this._cancelEvent(e),this.controls.indent.handler()):27==e.keyCode&&(this._cancelEvent(e),this.controls.close.handler());else{const n=e.keyCode;if(n<48||n>90)return;const i={z:t.undo,y:t.redo,b:t.controls.bold.handler,i:t.controls.italic.handler,u:t.controls.underline.handler,s:t.controls.close.handler,0:t.controls.clearFormat.handler}[String.fromCharCode(n).toLowerCase()];i&&(this._cancelEvent(e),i.call(this))}},this._cancelEvent=e=>{e.preventDefault(),e.stopPropagation()},this.undoValuesEqual=(e,t)=>e.snapshot==t.snapshot&&e.rootStyle==t.rootStyle&&e.rootClass==t.rootClass&&e.pageCSS==t.pageCSS,this._clearUndo=()=>{this._RTE_stack=Array(),this._RTE_redo_stack=Array(),this._addToUndo(),$("#undoBtn, #redoBtn").addClass("disabled")},this._addToUndo=(e,t)=>{const n=NEFW.getPreviewWindow(),i=this.element.html(),o=this.element.attr("style"),l=this.element.attr("class"),r=this._RTE_stack[this._RTE_stack.length-1],s=new te(i,o,l,n.getPageCSSToString());0!=this._RTE_stack.length&&this.undoValuesEqual(r,s)||(t&&this._RTE_stack.length>0&&t==this._RTE_stack[this._RTE_stack.length-1].currentHtmlSnapshot&&this._RTE_stack.pop(),this._RTE_stack.push(s),this._RTE_stack.length>m.a._UNDO_MAX_SIZE&&this._RTE_stack.splice(0,1),(null==e||e)&&(this._RTE_redo_stack=Array(),$("#redoBtn").addClass("disabled")),this._RTE_stack.length>1?$("#undoBtn").removeClass("disabled"):$("#undoBtn").addClass("disabled"))},this._undo=()=>{if(!$.dmx.current.element.attr||$.dmx.current.element.attr("duda_id")!=this.element.attr("duda_id"))return!1;if(null!=_RTE_Element&&this._RTE_stack.length>1){const e=NEFW.getPreviewWindow(),t=this.element.html();this._RTE_redo_stack.push({snapshot:t,rootStyle:this.element.attr("style"),rootClass:this.element.attr("class"),pageCSS:e.getPageCSSToString()}),this._RTE_stack.pop();const n=this._RTE_stack[this._RTE_stack.length-1];return this.element.html(n.snapshot),n.rootClass&&this.element.attr("class",n.rootClass),n.rootStyle?this.element.attr("style",n.rootStyle):this.element.removeAttr("style"),NEFW.PREVIEW.contents().eq(0).find("#pagestyle").html(n.pageCSS),this.refreshControlsState(),this._RTE_stack.length<=1&&$("#undoBtn").addClass("disabled"),$("#redoBtn").removeClass("disabled"),$.dmNotify("paragraph undo done"),this.fixSize(),!0}return!1},this._redo=()=>{if(!$.dmx.current.element.attr)return!1;if(null!=_RTE_Element&&this._RTE_redo_stack.length>0){const e=this._RTE_redo_stack.pop();return this.element.html(e.snapshot),e.rootClass?this.element.attr("class",e.rootClass):this.element.removeAttr("class"),e.rootStyle?this.element.attr("style",e.rootStyle):this.element.removeAttr("style"),NEFW.PREVIEW.contents().eq(0).find("#pagestyle").html(e.pageCSS),this.refreshControlsState(),this._addToUndo(!1),this._RTE_redo_stack.length>0?$("#redoBtn").removeClass("disabled"):$("#redoBtn").addClass("disabled"),$.dmNotify("paragraph redo done"),this.fixSize(),!0}return!1},this.removeSelection=()=>{ie().getSelection().removeAllRanges()},this.applyStyleOnSelection=e=>{let t=(e=e||{}).styleName,n=e.styleValue,i=e.execCommandKey;const o=this;if(n&&n.selectedData&&(n=n.selectedData.value),"font-family"===t){const e=$("#fontFamily").find("label.dd-selected-text");e.length>0&&e.css({"font-family":n}),n="'"+(n=(n=n.replace('"',"")).replace("'",""))+"'"}const l=this.element;let r=ie(),s=r.getSelection();if(s.isCollapsed&&"fontSize"==i)e.rte=this,Q(s,t,n,e);else if("font-weight"===t&&_.isUndefined(i))e.selectSurroundingNode=!0,e.rte=this,Q(s=$.extend({},s),t,n,e);else if("underline"==i&&s.rangeCount&&$(s.getRangeAt(0).commonAncestorContainer.parentNode).is("a"))$(s.getRangeAt(0).commonAncestorContainer.parentNode).css(t,n);else{if(r.execCommand("styleWithCSS",!1,!e.useStyleMarkupElements),$.browser.msie&&n.indexOf&&n.indexOf("rgba")>-1&&(n=function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}(n)),i&&i.startsWith("justify")){r.body.setAttribute("contenteditable",!0);var a=$("<br/>");a.insertAfter(l)}if(r.execCommand(i,!1,n),i&&i.startsWith("justify")&&(a.remove(),r.body.setAttribute("contenteditable",!1)),"foreColor"==i){$(o.getSelectedNodes()).each(function(e,i){let o=$(this);i&&3==i.nodeType&&(o=$(this).parent()),o.filter("a, ul").css(t,n),o.filter("li").parent("ul").css(t,n)})}i&&i.startsWith("justify")&&$(o.getSelectedNodes()).each(function(){const e="#text"==$(this).get(0).nodeName?$(this).parent():$(this);((e.attr("style")||"").match(/font-size\s*?:\s*?[\d\.]*?em/)||[]).length&&e.css("font-size","")})}this.fixSize(),l.focus()},this.getSaveData=()=>{const e=$(this.element),t=this.cleanClientGeneratedAttributesFromElement();return t.find(".annotation-bubble").remove(),{htmlAfter:t.outerHTML(),elementID:e.attr("idfm")||e.dmid(),device:$.dmfw.getDevice()}},this.onSavedFromLinkWidget=e=>{this.onSaved(e.inlineEdit)},this.onSaved=(e,t,n,i)=>{const o=this.element;if($.dmx.preview.wnd().$.editGrid.addWidgetToGrid(this.element,!0),e.markup.indexOf("dmNeedsRefresh")>=0||this.needsRefresh&&!t){let n=o.dmid();return e.markup.indexOf("ulwrap")>=0&&(n=$(e.markup).filter("[ulwrap]").dmid()),void $.dmfw.refreshPreview(()=>{if(!t){const e=$.dmfw.getByDmid(n);$.dmfw.selectAndOpenEditor(e)}})}$.dmops.refreshPageStyleCss(e.page_css,$.dmx.isHeader(o),$.dmx.isInner(o)),e.device_css&&$.dmops.refreshPageStyleDeviceCss(e.device_css,$.dmx.isHeader(o),$.dmx.isInner(o));let l=o;if(!i){(l=$(e.markup)).show();let t=o.css("display");-1==t.indexOf("important")&&(t+=" !important"),o.replaceWith(l),l.dmCss("display",t);const n=o.data("events");l.data("events",n)}t?$.removeRichTextEditor(this.editorId):null!=_RTE_Element&&(this.element=l,this.element.focus(),$.dmfw.setCurrent($.dmx.current.editable,l),this.savedHtml=this.element.clone());const r=l.attr("class");l.attr("class",r),l.find("*").each(function(){const e=$(this).attr("class");$(this).attr("class",e)}),$.dmfw.getPreviewElement("#tempstyle").html(""),NEFW.runPreviewStyleImages(),setTimeout("NEFW.runPreviewStyleImages()",30),setTimeout("NEFW.runPreviewStyleImages()",300),setTimeout("NEFW.runPreviewStyleImages()",3e3),this._clearUndo(),n&&n()},this.saveAndLock=e=>{this.allowContentEditable(!1),this.saveChanges(!1,e)},this.saveChanges=function(){var e=l()(function*(e,n){const i=t;t.allowContentEditable(!1);const o=(_RTE_Element&&_RTE_Element.element||t.element)[0],l=o.id;yield function(e){return G.apply(this,arguments)}({currentElement:o,elementId:l}),null==e&&(e=!0);const r=()=>{!function(e){q.apply(this,arguments)}({currentElement:o,elementId:l,applyBind:!0})};try{$.changePage({clientChange(){},serverChange(){const t=_RTE_Element&&_RTE_Element.element||this.element;url=$.dmx.isFastMigration2Site?"/fastmigration":"",url+="/pages/"+$.dmx.currentPage(t)+"/updateinlineedit",$.dmPostWithHistory({data:i.getSaveData(),url:url,success(t){i.onSaved(t,e,n,!0)}}).then(r)}}),$.onefw.showHelpTip("GRAB")}catch(e){$.dmNotify("js error")}});return function(t,n){return e.apply(this,arguments)}}(),this.allowContentEditable=e=>{if(null!=this.element)if(e)$.dmx.events.trigger("allowContentEditable",{element:this.element}),$(this.element).attr("contenteditable",e),$(this.element).addClass("inlineEditedElementAllowSelectText");else if($(this.element).removeClass("inlineEditedElementAllowSelectText"),$(this.element).removeAttr("contenteditable"),$(this.element).find("*").andSelf().filter("img").removeAttr("contenteditable"),$.dmx.isTouchDevice){$.dmx.preview.wnd().document.activeElement.blur(),$(this.element).blur();const e=$('<input style="width:1px;height:1px;border:none;margin:0;padding:0;" tabIndex="-1">').appendTo($(this.element));e.focus(),e[0].setSelectionRange(0,0),e.blur(),e.remove()}},this._getStyleValues=e=>{const t=[],n=$.dmx.preview.wnd().$;let i=n([]);const o=s.a.getSelection(NEFW.PREVIEW.get(0));if(o.refresh(),o.isCollapsed){if(0==o.getAllRanges().length){const e=NEFW.PREVIEW.contents().get(0),t=s.a.createRange(e);o.addRange(t)}if(n(o.getAllRanges()[0].commonAncestorContainer).is("div"))i=n(this.element);else{const e=o.getAllRanges()[0].commonAncestorContainer;e==NEFW.PREVIEW.contents().get(0)?i.push(NEFW.PREVIEW.contents().find("body")):i.push(n(e).parent())}}else if(0==(i=n(o.getRangeAt(0).getNodes([1]))).length){const e=n(o.getRangeAt(0).getNodes()).parent();i.push(e)}if("text-decoration"===e&&n(i[0]).is("span")){const t=n(i[0]).closest("div").parent(),o=n(i[0]).parentsUntil(t);for(let t=0;t<o.length;t++){const l=n(o[t]);if(l.css(e).indexOf("underline")>-1){i=l;break}}}return i.each((n,i)=>{const o=$.createRuntimeElement(i);let l=ne().documentStyles.dmCss(o,e);"font-weight"===e&&"700"==l&&(l="bold"),t.push(l)}),t},this._getSelectedElementWrappedByTag=(e,t,n)=>{let i;const o=t?e+"["+t+"]":e,l=this.getSelection();if(!l)return null;let r=l.commonAncestorContainer;if(!r)return null;if((r="#text"==r.nodeName?$(r.parentNode):$(r)).is(".inlineEditorParagraphSelected")&&1==r.children().length&&1==r[0].childNodes.length&&(r=$(r.children()[0])),(i=r.closest(o,this.element)).length)return i;return(i=$(l.endContainer.parentNode).closest(o,this.element)).length?i:(i=$(l.startContainer.parentNode).closest(o,this.element)).length?i:null},this._isSelectedElementOfWrappedByTag=(e,t)=>!!this._getSelectedElementWrappedByTag(e,t),this.cleanClientGeneratedAttributesFromElement=(e,t)=>{const n=$.dmx.preview.wnd().$;null==e&&(e=this.element),null==t&&(t=!0);const i={};$.each(e.find("*").filter("[id]"),(e,t)=>{const o=n(t);if(i[o.attr("id")]){const e="idd_"+Math.random().toString(36).substring(2,7);o.attr("id",e).attr("duda_id",e)}i[o.attr("id")]=!0}),$.each(e.find("*").filter("[style]"),(e,t)=>{const i=n(t),o=i.attr("style");i.attr("style",o.replaceAll('"',"'"))}),t&&(e=e.clone()),window.parent.$.dmx&&window.parent.$.dmx.isFastMigrationSite||$.dmx.preview.wnd().$.editGrid.destroyGridWidget(e);const o=e.find("*").andSelf();return null!=_RTE_Element&&$.each(o.filter('*[class=""]'),(e,t)=>{n(t).removeAttr("class")}),$.dmops.clearAnimationLeftovers(e),e.find("."+INLINE_EDITOR_EDITED_ELEMENT_CLASS).andSelf().removeClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS),e.find(".inlineEditorParagraphSelected").andSelf().removeClass("inlineEditorParagraphSelected"),e.find(".dmNowInlineEditing").andSelf().removeClass("dmNowInlineEditing"),e.find(".dmElementInlineSpaceableElement").andSelf().removeClass("dmElementInlineSpaceableElement"),e.find(".dmLocked").andSelf().removeClass("dmLocked"),o.removeAttr("contenteditable"),o.removeAttr("outline").removeAttr("highlight"),o.removeAttr("aria-describedby"),$.each(o.filter('*[class=""]'),(e,t)=>{n(t).removeAttr("class")}),e.find("a[runtime_url]").addBack("a[runtime_url]").each((e,t)=>{n(t).attr("href",n(t).attr("runtime_url")).removeAttr("raw_url")}),e.find("a[raw_url]").each((e,t)=>{n(t).removeAttr("raw_url")}),e},this.selectNode=e=>{if(!e)return;const t=ie().createRange();t.selectNodeContents($(e).get(0)),this.restoreSelection(t)},this.queryState=e=>ne().documentStyles.queryCommandState(e),this.queryValue=e=>ne().documentStyles.queryCommandValue(e),this.getSelection=()=>{const e=NEFW.getPreviewWindow().document,t=NEFW.getPreviewWindow().window;if(t.getSelection){const e=t.getSelection();if(e.getRangeAt&&e.rangeCount)return e.getRangeAt(0)}else if(e.selection&&e.selection.createRange)return e.selection.createRange();return null},this.restoreSelection=e=>{const t=NEFW.getPreviewWindow().document,n=NEFW.getPreviewWindow().window;if(e)if(n.getSelection){const t=n.getSelection();t.removeAllRanges(),t.addRange(e)}else t.selection&&e.select&&e.select()},this.getSelectedNodes=()=>{const e=this.getSelection();return!e||!1!==e.isCollapsed&&!1!==e.collapsed?[]:function(e){let t=e.startContainer;const n=e.endContainer;if(t==n)return[t];const i=[];for(;t&&t!=n;)i.push(t=ee(t));t=e.startContainer;for(;t&&t!=e.commonAncestorContainer;)i.unshift(t),t=t.parentNode;return i}(e)},this._handlePaste=e=>{let t;e.preventDefault(),(e.originalEvent||e).clipboardData?(t=((t=(e.originalEvent||e).clipboardData.getData("text/plain"))||"").replace(/\r\n/g,"\n"),ie().execCommand("insertText",!1,t)):window.clipboardData&&(t=window.clipboardData.getData("Text"),ie().selection.createRange().pasteHTML(t)),this._handleAction()},this._applyIndentation=e=>{this.applyStyleOnSelection({execCommandKey:e})},this._clearFormatting=()=>{this.applyStyleOnSelection({execCommandKey:"removeFormat"}),ie().execCommand("formatBlock",!1,"<div>");const e=ie().getSelection().getRangeAt(0);let t=e.commonAncestorContainer;t.innerHTML||(t=e.commonAncestorContainer.parentElement),t.className=t.className.replace(/(m-)?(font-)?size-[d]*\w+/g,""),t.innerHTML=t.innerHTML.replace(/(m-)?(font-)?size-[d]*\w+/g,""),this._addToUndo()},this._operateOnMatching=(e,t)=>{this.element.find(e).each(function(){t($(this))})},this._markInnerLists=(e,t)=>{e=e||"innerList defaultList",this._operateOnMatching("ul, ol",n=>{n.toggleClass(e,!t)})},this._removeLink=()=>{ie().execCommand("unlink",!1),this.controls.link.refreshState(!1),this.controls.underline.refreshState(!1)},this._changeHref=e=>{const t=ie();if(!(e=e||{}).href)return;t.execCommand("createLink",!1,e.href);const n=this._getSelectedElementWrappedByTag("a","href",!0);this.controls.link.refreshState(!0),this.controls.underline.refreshState(!0),$.setLinkAttributes(n,e);const i=this.element.find("[href='"+e.href+"']:not([runtime_url])");$.setLinkAttributes(i,e)},this._replaceStyleMarkupTags=()=>{const e={b:"strong",i:"em"},t=ie();this._operateOnMatching("b, i",n=>{const i=$(t.createElement(e[n[0].nodeName.toLowerCase()])).html(n.html());n.replaceWith(i)})},this._operateAfterExecCommand=(e,t)=>{const n=ie().getSelection().getRangeAt(0).commonAncestorContainer;let i=$(n);"#text"==n.nodeName&&(i=i.parent()),i.find(e).andSelf().each(function(){t($(this))})},this._fixFontSize=(e,t)=>{e.dmCss("font-size",t).dmCss("line-height","1em"),"mobile"===$.onefw.device()&&e.addClass("m-specific")},this._createAndAddClassForFontSize=(e,t)=>{let n=t.replace("px",""),i="";const o=$.dmx.preview.wnd().$;e.dmCss("font-size",""),"mobile"!==$.onefw.device()||window.parent.$.dmx&&window.parent.$.dmx.isFastMigrationSite?(i="font-size-"+n,e.hasClass("m-specific")||(n>36?(e.addClass("m-font-size-36"),e.addClass("lh-1")):e.removeClass("m-font-size-36")),e.find("*").andSelf().each((e,t)=>{const n=o(t);n.removeClassPrefix("font-size-"),n.removeClassPrefix("size-")}),e.addClass(i),e.addClass("lh-1")):(i="m-font-size-"+n,e.addClass("m-specific"),e.removeClassPrefix("m-font-size-"),e.addClass(i),e.addClass("lh-1"),e.find("*").each((e,t)=>{const n=o(t);n.removeClassPrefix("m-size-"),n.removeClassPrefix("m-font-size-"),$.each((n.attr("class")||"").match(/\bsize-\S+/g)||[],(e,t)=>{n.addClass(i)})})),e.is("span")&&e.parent("div.dmNewParagraph").length&&e.wrap("<div></div>")},this._handleAction=()=>{null!=_RTE_Element&&(this.fixSize(),this._addToUndo())},this._isAlreadyBlock=(e,t,n)=>"display"==t&&"block"==n&&"inline"!=e.dmCss("display"),this._this=this,this.controlsBar=$(".dmInlineRichTextEditorWrap"),function({currentElement:e}){Z()||F.a.isSMB()||e.addEventListener("keyup",X,{passive:!0})}({currentElement:e[0]}),this.element=e,this.editorId=$(e).dmid(),this.savedHtml=$(e).clone(),this.parentHtml=$(e).parent().clone(),this.needaRefresh=!1,this.dontRemoveEditor=!1,this.isEditorClosed=!0,this.keepEditableBar=!1,this.fontFamilyWeightsMap=null,this.fontWeightToName={100:Object(a.o)("ui.lightest"),200:Object(a.o)("ui.lighter"),300:Object(a.o)("ui.light"),400:Object(a.o)("ui.normal"),500:Object(a.o)("ui.medium"),600:Object(a.o)("ui.semibold"),700:Object(a.o)("ui.bold"),800:Object(a.o)("ui.bolder"),900:Object(a.o)("ui.boldest")},this.fontNameToWeight=this.fontNameToWeight(),this.controls=g(this._this),window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{K()})})}}function Q(e,t,n,i={}){try{let e;const o=ie().getSelection(),l=o.isCollapsed,r=o.getRangeAt(0);let s=function(e){if(null===e)return null;let t=e.commonAncestorContainer.parentElement;"i"===t.nodeName.toLowerCase()?t=!(!t.parentNode||"span"!==t.parentNode.nodeName.toLowerCase())&&t.parentNode:"span"!==t.nodeName.toLowerCase()&&(t=!1);return t}(r);if(function(e,t,n){if(commonProps["editor.rte.revertFontWeightFix"])return;if("font-weight"===t){const i=$.trim($.dmx.current.editable.element.get(0).textContent).length,o=e.extractContents(),l=$.trim(o.textContent).length,r=i==l;if(e.insertNode(o),r)$.dmx.current.editable.element.find("span, div").each(function(){$(this).attr("style",function(e,t){const n=t,i=t?t.replace(/font-weight[^;]+;?/g,""):"";return t&&n!==i&&$(this).attr("data-removed-font-weight",!0),i})}),function(){const e=$.dmx.current.editable.element;e.find("span, div").each(function(){$(this).attr("style")||$(this).attr("class")||$(this).attr("data-removed-font-weight")&&$(this).addClass("readyToUnwrap")});for(;e.find(".readyToUnwrap").length>0;){const t=e.find(".readyToUnwrap:first");t.replaceWith(t.html())}$("[data-removed-font-weight]").removeAttr("data-removed-font-weight")}(),function(e,t){if("font-weight"===e){const n=$(ie().createElement("div"));n.css(e,t),$.dmx.current.editable.element.wrapInner(n)}}(t,n)}}(r,t,n),s&&"font-weight"!==t)$(s).css(t,n);else{if("font-weight"===t){const e=r.commonAncestorContainer,i=e.parentElement;if("span"===e.nodeName.toLowerCase())return void $(e).css(t,n);if("span"===i.nodeName.toLowerCase()&&0==r.startOffset)return void $(i).css(t,n)}s=$(ie().createElement("span")),"font-size"===t?i.rte._createAndAddClassForFontSize(s,n):s.css(t,n);const a=s.get(0);a.appendChild(r.extractContents()),"font-weight"===t&&$(a).find("span").length>0&&$(a).find("span").css("font-weight","inherit"),r.insertNode(a),l&&s.html("&nbsp"),i.selectSurroundingNode?(e=i.rte||this).selectNode(s):(r.selectNodeContents(s.get(0)),o.removeAllRanges(),o.addRange(r))}}catch(e){console.log(`RTE wrapWithStyle error: ${e.message}`)}}function ee(e){if(e.hasChildNodes())return e.firstChild;for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null}function te(e,t,n,i){this.snapshot=e,this.rootStyle=t,this.rootClass=n,this.pageCSS=i}function ne(){return NEFW.getPreviewWindow().window}function ie(){return NEFW.getPreviewWindow().document}Y.displayName="RichTextEditor"},Cmew:function(e,t,n){"use strict";var i=n("4qC0"),o=n.n(i);function l(e){const t=r(e);return t?{}:{general:`font-size-${t}`,mobile:"m-font-size-"+Math.min(t,36)}}function r(e){try{return parseInt(e,10)}catch(e){return null}}function s(e,t,n={}){if(!e||!t)return;const i=$(e).attr("style")||"";let l="",r="";o()(t)?r=t:$.each(t,(e,t)=>{r+=e+":"+t+";"}),l=n.beforeExistingStyle?r+";"+i+";":i+";"+r+";",$(e).attr("style",function(e){let t=(e||"").replace(/;+/g,";");";"===t&&(t="");return t}(l))}t.a={sanitize:function(e){let t=e;const n=$.dmx.isFastMigrationSite;n||t[0]&&"p"===t[0].tagName.toLowerCase()&&(t=e.changeTagType("div"),$.dmx.current.element=t);const i=$.dmops.getPageCssRules({isHeader:$.dmx.isHeader(t)}),o=$.dmops.getPageCssRules({isHeader:$.dmx.isHeader(t),currentDevice:!0}),a={};let d=-1,c=null;$.each((e.attr("class")||"").match(/\bu_\S+/g)||[],(t,n)=>{const o=i["."+n+" *"];if(o){d=o.index;const t={};$.each(o,(e,n)=>{t[e]=n,["text-decoration","font-weight","font-family","text-align","color"].contains(e)&&(a[e]=n),"font-size"===e&&(-1===n.indexOf("em")?c=r(n.replace("px","")):a[e]=n)}),e.find("a").each((e,n)=>{s(n,t,{beforeExistingStyle:!0})})}$.dmops.removeRuleFromPage("."+n+" *",{isHeader:$.dmx.isHeader(e)})});const m=l(c);return e.find("[duda_id]:not(br,img)").each((e,t)=>{let c=m,h=a;const f=$(t);$.each((f.attr("class")||"").match(/\bu_\S+/g)||[],(e,t)=>{const n={},u={},g=i["."+t]||{},p=o["."+t]||{},E=i["."+t+" *"]||{},_={};$.each(E,(e,t)=>{["color"].contains(e)&&(_[e]=t)}),Object.isEmpty(_)||f.find("a").each((e,t)=>{s(t,_,{beforeExistingStyle:!0})}),$.each(g,(e,t)=>{"font-size"!==e||-1!==t.indexOf("em")?n[e]=t:c=l(t)}),g.index<d?(h=$.extend({},n,a),c=$.extend({},c,m)):(h=$.extend({},a,n),c=$.extend({},m,c)),$.each(p,(e,t)=>{if("font-size"!==e||-1!==t.indexOf("em"))u[e]=t;else if("mobile"===$.dmfw.getDevice()){const e=r(t);e&&(c.mobile=`m-size-${e}`,c.mobileSpec=!0)}}),h=$.extend(h,u),f.removeClass(t)}),n||((f.attr("class")||"").match(/\bdm[A-Z]\S+/g)||[]).length||f.removeAttr("duda_id id"),s(t,h,{beforeExistingStyle:!0}),c.general&&f.addClass(c.general),c.mobile&&f.addClass(c.mobile),c.mobileSpec&&f.addClass("m-specific")}),t}}},EOhk:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return l}),n.d(t,"b",function(){return r});var i=n("AXiQ"),o=n("Cmew");const l={_redraw_timer:null,_saved_selection:null,_UNDO_MAX_SIZE:50};function r(){e._RTE_Element=null,$.extend({initRichTextEditor:s,preloadRichTextEditor:a,removeRichTextEditor:d})}function s(t,n){if($("body").off("click.closeRte").on("click.closeRte","[data-role=leftPanel], [data-role=topBar]",()=>{$.removeRichTextEditor(),$("body").off("click.closeRte")}),$.setTestProperty("rteReady",!1),null===e._RTE_Element||null===e._RTE_Element.element||n){let n=$(t);if(!n.length)return;n[0].dispatchEvent(new CustomEvent("rich-text-editor-initializing",{bubbles:!0,cancelable:!0})),n.lockElement({hideOverlay:!0,hideResizers:!0}),e._RTE_Element=new i.a(n),n=e._RTE_Element.element=o.a.sanitize(e._RTE_Element.element),e._RTE_Element._RTE_stack=[],e._RTE_Element._RTE_redo_stack=[],$.dmx.events.on("d1rte.initialized",c,!0),e._RTE_Element.initializeEditor(),n.focus(),n.removeClass("dmParagraphPlaceholder").removeClass("dmTitlePlaceholder")}else c()}function a(){e._RTE_Element=new i.a($("<div></div>")),e._RTE_Element.preloadEditor()}function d(t,n){if(e._RTE_Element&&e._RTE_Element.isClosed())return;if($.dmfw.getPreviewElement("#iscrollBody").off("scroll.positionEditor"),$($.dmx.preview.wnd()).off("scroll.positionEditor"),null!==e._RTE_Element){if(e._RTE_Element.element[0].dispatchEvent(new CustomEvent("rich-text-editor-destructing",{bubbles:!0,cancelable:!0})),e._RTE_Element.element.removeClass("inlineEditedElementHighlight inlineEditedElementHighlightNoBorder"),e._RTE_Element.element[0].classList.remove("locked"),e._RTE_Element.element[0].classList.remove("ui-current-element"),e._RTE_Element.dontRemoveEditor)return void(e._RTE_Element.dontRemoveEditor=!1);if(t&&t!==e._RTE_Element.editorId);else{e._RTE_Element.removeSelection(),e._RTE_Element.remove(n);const t=e._RTE_Element.useSpotlight();$.dmops.checkEmptyContent(),$.dmops.checkEmptyParagraph(e._RTE_Element.element),e._RTE_Element=null,$.dmx.preview.wnd().setEventsFirePolicy(!0),t&&$.dm.spotlight&&$.dm.spotlight.removeSpotlight()}}$.setTestProperty("rteReady",!1)}function c(){e._RTE_Element.allowContentEditable(!0),e._RTE_Element.useSpotlight()&&$.dm.spotlight&&$.dm.spotlight.setSpotlight(e._RTE_Element.element,{onRemove(){$.deselectAllEditableElements()}}),$.setTestProperty("rteReady",!0)}}).call(this,n("yLpj"))},n5t8:function(e,t,n){"use strict";n.r(t);var i=n("8OQS"),o=n.n(i),l=n("yXPU"),r=n.n(l),s=n("EOhk");function a(){return d.apply(this,arguments)}function d(){return(d=r()(function*(e={}){o()(e,["containerId"]);Object(s.b)()})).apply(this,arguments)}function c(){}n.d(t,"init",function(){return a}),n.d(t,"clean",function(){return c})}}]);